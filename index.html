<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tabele i terminarz – siatkówka</title>
<style>
  :root{
    --pzps-blue:#0d3b66;
    --pzps-gold:#c9a227;
    --row-alt:#f7f8fa;
    --text:#1c1c1c;
    --muted:#6b7280;
    --win:#e7f6ec;
    --loss:#fdecec;
  }
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);background:#f2f5f9;}
  header.site-header{background:var(--pzps-blue);color:#fff;padding:18px 16px;box-shadow:0 2px 8px rgba(0,0,0,.08);}
  .site-header .wrap{max-width:1100px;margin:0 auto;}
  .site-title{margin:0;font-weight:700;font-size:clamp(18px,2.3vw,24px);}
  .container{max-width:1100px;margin:28px auto;padding:0 16px;}
  .card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 18px rgba(13,59,102,.08);margin-bottom:20px;border:1px solid #e8edf3;}
  .card-header{background:linear-gradient(180deg, #114676 0%, #0d3b66 100%);color:#fff;padding:14px 16px;border-bottom:3px solid var(--pzps-gold);}
  .card-header h2{margin:0;font-size:clamp(16px,2vw,20px);}
  .card-body{padding:12px 14px;}
  .table-wrap{overflow-x:auto;}
  table.pzps{width:100%;border-collapse:collapse;min-width:560px;}
  table.pzps thead th{text-align:center;font-weight:700;color:#fff;background:var(--pzps-blue);padding:10px 8px;}
  table.pzps tbody td{padding:10px 8px;text-align:center;border-bottom:1px solid #eef2f6;}
  table.pzps tbody tr:nth-child(even){background:var(--row-alt);}
  .chip{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;border:1px solid transparent;}
  .chip-cat{background:#f9fafb;color:#334155;border-color:#e5e7eb;}
</style>
</head>
<body>
<header class="site-header">
  <div class="wrap">
    <h1 class="site-title">Tabele, terminarze i rankingi – siatkówka młodzieżowa</h1>
  </div>
</header>
<main class="container">

  <!-- Ranking Młodzik -->
  <section class="card">
    <div class="card-header"><h2>Ranking – Młodzik</h2></div>
    <div class="card-body">
      <div class="table-wrap">
        <table class="pzps" id="tbl-ranking-mlodzik">
          <thead><tr><th>Drużyna</th><th>Punkty</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Ranking Młodziczka -->
  <section class="card">
    <div class="card-header"><h2>Ranking – Młodziczka</h2></div>
    <div class="card-body">
      <div class="table-wrap">
        <table class="pzps" id="tbl-ranking-mlodziczka">
          <thead><tr><th>Drużyna</th><th>Punkty</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Terminarz Młodzik -->
  <section class="card">
    <div class="card-header"><h2>Terminarz – Młodzik</h2></div>
    <div class="card-body">
      <div class="table-wrap">
        <table class="pzps" id="tbl-terminarz-mlodzik">
          <thead><tr><th>Data</th><th>Gospodarz</th><th>Gość</th><th>Wynik</th><th>Sety</th><th>Grupa</th><th>Protokół</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Terminarz Młodziczka -->
  <section class="card">
    <div class="card-header"><h2>Terminarz – Młodziczka</h2></div>
    <div class="card-body">
      <div class="table-wrap">
        <table class="pzps" id="tbl-terminarz-mlodziczka">
          <thead><tr><th>Data</th><th>Gospodarz</th><th>Gość</th><th>Wynik</th><th>Sety</th><th>Grupa</th><th>Protokół</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

</main>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbw_qZZONOjmKCvve27HuOJSm7waQcbXro0fKg1PX0E5Yg_dL0nkldZCKScyUo4WqUcK/exec?action=get";

function createCell(text, opts={}) {
  const td = document.createElement('td');
  if (opts.left) td.style.textAlign = 'left';
  if (opts.link) {
    const a = document.createElement('a');
    a.href = text; a.textContent = "protokół"; a.target="_blank";
    td.appendChild(a);
  } else {
    td.textContent = text ?? '';
  }
  return td;
}

function formatDate(d) {
  const dt = new Date(d);
  return !isNaN(dt) ? dt.toLocaleDateString('pl-PL') : d;
}

async function loadData(){
  try {
    const res = await fetch(WEB_APP_URL, { cache:'no-store' });
    const data = await res.json();

    // Ranking Młodzik
    const tbRM = document.querySelector('#tbl-ranking-mlodzik tbody');
    tbRM.innerHTML = '';
    (data.ranking_mlodzik || []).forEach(row => {
      const tr = document.createElement('tr');
      tr.appendChild(createCell(row.team, {left:true}));
      tr.appendChild(createCell(row.points));
      tbRM.appendChild(tr);
    });

    // Ranking Młodziczka
    const tbRF = document.querySelector('#tbl-ranking-mlodziczka tbody');
    tbRF.innerHTML = '';
    (data.ranking_mlodziczka || []).forEach(row => {
      const tr = document.createElement('tr');
      tr.appendChild(createCell(row.team, {left:true}));
      tr.appendChild(createCell(row.points));
      tbRF.appendChild(tr);
    });

    // Terminarz Młodzik
    const tbTM = document.querySelector('#tbl-terminarz-mlodzik tbody');
    tbTM.innerHTML = '';
    (data.m_elim || []).forEach(row => {
      const [date, home, away, score, sets, group, protocol] = row;
      const tr = document.createElement('tr');
      tr.appendChild(createCell(formatDate(date)));
      tr.appendChild(createCell(home));
      tr.appendChild(createCell(away));
      tr.appendChild(createCell(score));
      tr.appendChild(createCell(sets));
      tr.appendChild(createCell(group));
      tr.appendChild(createCell(protocol, {link:true}));
      tbTM.appendChild(tr);
    });

    // Terminarz Młodziczka
    const tbTF = document.querySelector('#tbl-terminarz-mlodziczka tbody');
    tbTF.innerHTML = '';
    (data.f_elim || []).forEach(row => {
      const [date, home, away, score, sets, group, protocol] = row;
      const tr = document.createElement('tr');
      tr.appendChild(createCell(formatDate(date)));
      tr.appendChild(createCell(home));
      tr.appendChild(createCell(away));
      tr.appendChild(createCell(score));
      tr.appendChild(createCell(sets));
      tr.appendChild(createCell(group));
      tr.appendChild(createCell(protocol, {link:true}));
      tbTF.appendChild(tr);
    });

  } catch (err) {
    console.error("Błąd wczytywania danych:", err);
  }
}

loadData();
</script>
</body>
</html>
