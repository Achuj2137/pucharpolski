<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tabele i Terminarz – siatkówka</title>
<style>
  :root{
    --pzps-blue:#0d3b66;
    --pzps-gold:#c9a227;
    --row-alt:#f7f8fa;
    --text:#1c1c1c;
    --muted:#6b7280;
    --win:#e7f6ec;
    --loss:#fdecec;
  }
  body{ margin:0; font-family:system-ui, Arial, sans-serif; background:#f2f5f9; color:var(--text);}
  header.site-header{background:var(--pzps-blue);color:#fff;padding:18px 16px;}
  .site-title{margin:0; font-weight:700;}
  .container{max-width:1100px;margin:28px auto;padding:0 16px;}
  .card{background:#fff;border-radius:12px;overflow:hidden;margin-bottom:20px;border:1px solid #e8edf3;box-shadow:0 6px 18px rgba(13,59,102,.08);}
  .card-header{background:linear-gradient(180deg,#114676,#0d3b66);color:#fff;padding:14px 16px;border-bottom:3px solid var(--pzps-gold);}
  .card-body{padding:12px 14px;}
  .note{color:var(--muted);font-size:13px;margin-top:8px;}
  table.pzps{width:100%;border-collapse:collapse;min-width:560px;}
  table.pzps th{background:var(--pzps-blue);color:#fff;padding:10px;}
  table.pzps td{padding:10px;text-align:center;border-bottom:1px solid #eef2f6;}
  table.pzps tbody tr:nth-child(even){background:var(--row-alt);}
  tr.win-row{background:var(--win)!important;}
  tr.loss-row{background:var(--loss)!important;}
  .chip{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;border:1px solid transparent;}
  .chip-cat{background:#f9fafb;color:#334155;border-color:#e5e7eb;}
  .chip-win{background:var(--win);color:#14532d;border-color:#c8e8d3;}
  .chip-loss{background:var(--loss);color:#7f1d1d;border-color:#f6c7c7;}
</style>
</head>
<body>
<header class="site-header"><h1 class="site-title">Tabele i terminarz – siatkówka młodzieżowa</h1></header>
<main class="container">

<section class="card">
  <div class="card-header"><h2>MŁODZIK</h2></div>
  <div class="card-body">
    <table class="pzps" id="tbl-mlodzik">
      <thead><tr><th>Drużyna</th><th>M</th><th>W</th><th>P</th><th>Małe pkt</th><th>Punkty</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<section class="card">
  <div class="card-header"><h2>MŁODZICZKA</h2></div>
  <div class="card-body">
    <table class="pzps" id="tbl-mlodziczka">
      <thead><tr><th>Drużyna</th><th>M</th><th>W</th><th>P</th><th>Małe pkt</th><th>Punkty</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<section class="card">
  <div class="card-header"><h2>TERMINARZ</h2></div>
  <div class="card-body">
    <table class="pzps" id="tbl-terminarz">
      <thead><tr><th>Data</th><th>Gospodarz</th><th>Gość</th><th>Wynik</th><th>Sety</th><th>Kategoria</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</section>

</main>

<script>
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbx9Vq-obHD0tFX2e9e0bzYqBwFO9LdGShK9j5-6M7wDvwwFEfE65X7VHTEDR66xAT6jowEi9V/exec";

  function chip(text, cls='chip'){ return `<span class="chip ${cls}">${text}</span>`; }

  async function loadData() {
    let data;
    if (typeof google !== 'undefined' && google.script) {
      // Google Apps Script – pobranie lokalne
      data = await new Promise(res => google.script.run.withSuccessHandler(res).readAll());
    } else {
      // GitHub Pages – fetch z CORS
      const res = await fetch(WEB_APP_URL + "?action=get", {cache: 'no-store'});
      data = await res.json();
    }

    // ===== TABELA MŁODZIK =====
    const tbM = document.querySelector('#tbl-mlodzik tbody');
    tbM.innerHTML = data.tabela_mlodzik.map(r =>
      `<tr><td>${r.team}</td><td>${r.matches}</td><td>${r.wins}</td><td>${r.losses}</td><td>${r.smallPoints}</td><td>${r.scoreTable}</td></tr>`
    ).join('');

    // ===== TABELA MŁODZICZKA =====
    const tbF = document.querySelector('#tbl-mlodziczka tbody');
    tbF.innerHTML = data.tabela_mlodziczka.map(r =>
      `<tr><td>${r.team}</td><td>${r.matches}</td><td>${r.wins}</td><td>${r.losses}</td><td>${r.smallPoints}</td><td>${r.scoreTable}</td></tr>`
    ).join('');

    // ===== TERMINARZ =====
    const tbT = document.querySelector('#tbl-terminarz tbody');
    tbT.innerHTML = data.terminarz.map(row => {
      const [date, home, away, wynik, sety, kat] = row;
      let cls = '';
      if (wynik && wynik.includes(':')) {
        const [h,a] = wynik.split(':').map(Number);
        if (h > a) cls = 'win-row';
        else if (h < a) cls = 'loss-row';
      }
      return `<tr class="${cls}"><td>${date}</td><td>${home}</td><td>${away}</td><td>${wynik || ''}</td><td>${sety || ''}</td><td>${chip(kat,'chip-cat')}</td></tr>`;
    }).join('');
  }

  loadData();
</script>
</body>
</html>
