<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tabele i Terminarz – siatkówka</title>

<style>
  :root{
    --pzps-blue:#0d3b66;
    --pzps-gold:#c9a227;
    --row-alt:#f7f8fa;
    --text:#1c1c1c;
    --muted:#6b7280;
    --win:#e7f6ec;
    --loss:#fdecec;
  }
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    background:#f2f5f9;
  }
  header.site-header{
    background:var(--pzps-blue);
    color:#fff;
    padding:18px 16px;
    box-shadow:0 2px 8px rgba(0,0,0,.08);
  }
  .site-header .wrap{
    max-width:1100px; margin:0 auto; display:flex; gap:16px; align-items:center; justify-content:space-between;
  }
  .site-title{
    margin:0; font-weight:700; letter-spacing:.3px; font-size: clamp(18px,2.3vw,24px);
  }
  .container{ max-width:1100px; margin:28px auto; padding:0 16px; }
  .card{
    background:#fff; border-radius:12px; overflow:hidden;
    box-shadow:0 6px 18px rgba(13,59,102,.08);
    margin-bottom:20px;
    border:1px solid #e8edf3;
  }
  .card-header{
    display:flex; align-items:center; justify-content:space-between;
    background:linear-gradient(180deg, #114676 0%, #0d3b66 100%);
    color:#fff; padding:14px 16px; border-bottom:3px solid var(--pzps-gold);
  }
  .card-header h2{ margin:0; font-size: clamp(16px,2vw,20px); font-weight:700; }
  .card-body{ padding:12px 14px; }
  .note{ color:var(--muted); font-size:13px; margin:4px 0 10px; }
  .table-wrap{ overflow-x:auto; }
  table.pzps{
    width:100%; border-collapse:collapse; min-width:560px;
  }
  table.pzps thead th{
    text-align:center; font-weight:700; color:#fff; background:var(--pzps-blue);
    padding:10px 8px; position:sticky; top:0; z-index:1;
  }
  table.pzps tbody td{
    padding:10px 8px; text-align:center; border-bottom:1px solid #eef2f6;
  }
  table.pzps tbody tr:nth-child(even){ background:var(--row-alt); }
  .chip{
    display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px; line-height:1; border:1px solid transparent;
  }
  .chip-cat{ background:#f9fafb; color:#334155; border-color:#e5e7eb; }
  .chip-win{ background:var(--win); color:#14532d; border-color:#c8e8d3; }
  .chip-loss{ background:var(--loss); color:#7f1d1d; border-color:#f6c7c7; }
  tr.win-row   { background:var(--win) !important; }
  tr.loss-row  { background:var(--loss) !important; }
  @media (max-width:640px){
    .card-body{ padding:10px 8px; }
    table.pzps{ min-width:520px; }
    table.pzps thead th, table.pzps tbody td{ padding:8px 6px; font-size:14px; }
  }
</style>
</head>
<body>

<header class="site-header">
  <div class="wrap">
    <h1 class="site-title">Tabele i terminarz – siatkówka młodzieżowa</h1>
  </div>
</header>

<main class="container">

  <section class="card">
    <div class="card-header"><h2>MŁODZIK</h2></div>
    <div class="card-body">
      <div class="table-wrap">
        <table class="pzps" id="tbl-mlodzik">
          <thead><tr><th style="text-align:left;padding-left:12px;">Drużyna</th><th>M</th><th>W</th><th>P</th><th>Małe pkt</th><th>Punkty</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="card-header"><h2>MŁODZICZKA</h2></div>
    <div class="card-body">
      <div class="table-wrap">
        <table class="pzps" id="tbl-mlodziczka">
          <thead><tr><th style="text-align:left;padding-left:12px;">Drużyna</th><th>M</th><th>W</th><th>P</th><th>Małe pkt</th><th>Punkty</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="card-header"><h2>TERMINARZ</h2></div>
    <div class="card-body">
      <div class="table-wrap">
        <table class="pzps" id="tbl-terminarz">
          <thead><tr><th>Data</th><th>Gospodarz</th><th>Gość</th><th>Wynik</th><th>Sety</th><th>Kategoria</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

</main>

<script>
  const WEB_APP_URL = '<?= ScriptApp.getService().getUrl() ?>';

  function parseDateAny(v){
    if (v instanceof Date && !isNaN(v)) return v;
    if (typeof v === 'string' && v.includes('.')){
      const [d,m,y] = v.split('.').map(Number);
      return new Date(y, m-1, d);
    }
    return new Date(v);
  }

  function fmtDatePL(v){
    const d = parseDateAny(v);
    return isNaN(d) ? v : d.toLocaleDateString('pl-PL');
  }

  function chip(text, cls='chip'){
    const span = document.createElement('span');
    span.className = `chip ${cls}`;
    span.textContent = text;
    return span;
  }

  async function loadData(){
    const res = await fetch(WEB_APP_URL + "?action=get");
    const data = await res.json();

    const tbM = document.querySelector('#tbl-mlodzik tbody');
    tbM.innerHTML = '';
    data.tabela_mlodzik.forEach(row => {
      tbM.innerHTML += `<tr>
        <td>${row.team}</td><td>${row.matches}</td><td>${row.wins}</td>
        <td>${row.losses}</td><td>${row.smallPoints}</td><td>${row.scoreTable}</td>
      </tr>`;
    });

    const tbF = document.querySelector('#tbl-mlodziczka tbody');
    tbF.innerHTML = '';
    data.tabela_mlodziczka.forEach(row => {
      tbF.innerHTML += `<tr>
        <td>${row.team}</td><td>${row.matches}</td><td>${row.wins}</td>
        <td>${row.losses}</td><td>${row.smallPoints}</td><td>${row.scoreTable}</td>
      </tr>`;
    });

    const tbT = document.querySelector('#tbl-terminarz tbody');
    tbT.innerHTML = '';
    data.terminarz.forEach(row => {
      const [date, home, away, wynik, sety, kat] = row;
      tbT.innerHTML += `<tr>
        <td>${fmtDatePL(date)}</td><td>${home}</td><td>${away}</td>
        <td>${wynik || ''}</td><td>${sety || ''}</td>
        <td><span class="chip chip-cat">${kat}</span></td>
      </tr>`;
    });
  }

  loadData();
</script>

</body>
</html>
